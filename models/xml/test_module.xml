<mujoco model="modular">

  <!-- Environment --> 
  <option timestep="0.001" gravity="0 0 0" integrator="implicit" density="1025" viscosity="0.0009" iterations="50" solver="Newton"/>
  <include file="environment.xml"/>
  
  <!-- Modular robot asset -->
  <asset>
    <model name="modbot" file="modular.xml"/>
  </asset>

  <!-- Initial configuration -->
  <keyframe>
    <key name="init_pose"
         qpos="0.0 0.0 0.5 1.0 0.0 0.0 0.0 0.7854 -0.3926 0.7854 -0.3926 0.7854 -0.3926"/>
  </keyframe>

  <!-- Robot model -->
  <worldbody>
    <!-- Colony -->
    <body name="colony" pos="0 0 0.5">
      <site name="COM" pos="0 0 0" quat="1 0 0 0"/>
      <joint name="base" type="free"/>

      <!-- Robot 1 -->
      <body name="bot1" pos="0 -0.05 0" quat="1 0 0 0">
        <attach model="modbot" body="main_body" prefix="r1_"/>
      </body>
      
      <!-- Robot 2 -->
      <body name="bot2" pos="0.03 -0.01 0" quat="0.5 0 0 0.8660254">
        <attach model="modbot" body="main_body" prefix="r2_"/>
      </body>

      <!-- Robot 3 -->
      <body name="bot3" pos="-0.02 0 0" quat="0.5 0 0 -0.8660254">
        <attach model="modbot" body="main_body" prefix="r3_"/>
      </body>
    </body>
  </worldbody>

  <!-- Entire colony wrench -->
  <sensor>
    <force name="colony_force" site="COM"/>
    <torque name="colony_torque" site="COM"/>
  </sensor>

</mujoco>
